# 外部 MySQL 配置
# 使用方式: docker-compose -f docker-compose.yml -f docker-compose.external.yml up -d

services:
  # 覆盖面板服务，使用外部数据库
  bakaray-panel:
    environment:
      # 外部数据库配置
      - DB_TYPE=${DB_TYPE:-mysql}
      - DB_HOST=${DB_HOST:-localhost}
      - DB_PORT=${DB_PORT:-3306}
      - DB_USERNAME=${DB_USERNAME:-root}
      - DB_PASSWORD=${DB_PASSWORD:-}
      - DB_NAME=${DB_NAME:-bakaray}

  # Redis 配置（使用相同密码）
  bakaray-redis:
    command: redis-server --appendonly yes --requirepass bakaray-redis-password
    healthcheck:
      test: ["CMD", "redis-cli", "-a", "bakaray-redis-password", "ping"]
